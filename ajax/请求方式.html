<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Examples</title>
<meta name="description" content="">
<meta name="keywords" content="">
<link href="" rel="stylesheet">
<script src="axios.js"></script>
</head>
<body>
  
  <button id="btn">send</button>
  <div id="box"></div>

  <script>

    // axios
    // 
    // btn.onclick = function(){
    //   axios.get("http://musicapi.leanapp.cn/artist/list?cat=1001")
    //   .then(function(res){
    //     console.log(res.data.artists);
    //     var list = res.data.artists;
    //     var html = [];
    //     for(var i = 0;i < list.length;i++){
    //       html.push('<p>'+list[i].name+'</p><p><img src="'+list[i].picUrl+'" alt="" /></p>');
    //     }
    //     box.innerHTML = html.join('');
    //   });
    // }

    // ajax
    // 
    // btn.onclick = function(){

    //   var xhr = new XMLHttpRequest();
    //   xhr.open("GET","http://musicapi.leanapp.cn/artist/list?cat=1001");
    //   xhr.send();
    //   xhr.onreadystatechange = function(){
    //     if(xhr.readyState == 4 && xhr.status == 200){
    //       // console.log(JSON.parse(xhr.responseText));
    //       var list = JSON.parse(xhr.responseText).artists;
    //       console.log(list);
    //       var html = [];
    //       for(var i = 0;i < list.length;i++){
    //         html.push('<p>'+list[i].name+'</p><p><img src="'+list[i].picUrl+'" alt="" /></p>');
    //       }
    //       box.innerHTML = html.join('');
    //     }
    //   }

    // }
    

    // promise
    // 
    btn.onclick = function(){

      ajax("http://musicapi.leanapp.cn/artist/list?cat=1001").then((res)=>{
        var list = res.artists;
        console.log(list);
        var html = [];
        for(var i = 0;i < list.length;i++){
          html.push('<p>'+list[i].name+'</p><p><img src="'+list[i].picUrl+'" alt="" /></p>');
        }
        box.innerHTML = html.join('');
      });
      
    }

    // 封装promise
    // 
    function ajax(url){
      return new Promise((resolve,reject)=>{
        var xhr=new XMLHttpRequest();
        xhr.open("GET",url);
        xhr.send();
        xhr.onreadystatechange=function(){
          if(xhr.status==200&&xhr.readyState==4){
            resolve(JSON.parse(xhr.responseText));
          }
        }
      });
    }

  </script>

</body>
</html>













